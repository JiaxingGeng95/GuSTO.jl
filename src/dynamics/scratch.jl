xdot[24] = p1*(Jinv11*((-J[3,1])*w[2] + J[2,1]*w[3]) + Jinv13*(-2*J[2,1]*w[1] + J[1,1]*w[2] - J[2,2]*w[2] - J[2,3]*w[3]) + Jinv12*(2*J[3,1]*w[1] + J[3,2]*w[2] - J[1,1]*w[3] + J[3,3]*w[3])) +
  						p2*(Jinv21*((-J[3,1])*w[2] + J[2,1]*w[3]) + Jinv23*(-2*J[2,1]*w[1] + J[1,1]*w[2] - J[2,2]*w[2] - J[2,3]*w[3]) + Jinv22*(2*J[3,1]*w[1] + J[3,2]*w[2] - J[1,1]*w[3] + J[3,3]*w[3])) +
  						p3*(Jinv31*((-J[3,1])*w[2] + J[2,1]*w[3]) + Jinv33*(-2*J[2,1]*w[1] + J[1,1]*w[2] - J[2,2]*w[2] - J[2,3]*w[3]) + Jinv32*(2*J[3,1]*w[1] + J[3,2]*w[2] - J[1,1]*w[3] + J[3,3]*w[3]))
xdot[25] = p1*(Jinv12*(J[3,2]*w[1] - J[1,2]*w[3]) + Jinv13*(J[1,1]*w[1] - J[2,2]*w[1] + 2*J[1,2]*w[2] + J[1,3]*w[3]) + Jinv11*((-J[3,1])*w[1] - 2*J[3,2]*w[2] + J[2,2]*w[3] - J[3,3]*w[3])) +
  						p2*(Jinv22*(J[3,2]*w[1] - J[1,2]*w[3]) + Jinv23*(J[1,1]*w[1] - J[2,2]*w[1] + 2*J[1,2]*w[2] + J[1,3]*w[3]) + Jinv21*((-J[3,1])*w[1] - 2*J[3,2]*w[2] + J[2,2]*w[3] - J[3,3]*w[3])) +
  						p3*(Jinv32*(J[3,2]*w[1] - J[1,2]*w[3]) + Jinv33*(J[1,1]*w[1] - J[2,2]*w[1] + 2*J[1,2]*w[2] + J[1,3]*w[3]) + Jinv31*((-J[3,1])*w[1] - 2*J[3,2]*w[2] + J[2,2]*w[3] - J[3,3]*w[3]))
xdot[26] = p1*(Jinv13*((-J[2,3])*w[1] + J[1,3]*w[2]) + Jinv12*((-J[1,1])*w[1] + J[3,3]*w[1] - J[1,2]*w[2] - 2*J[1,3]*w[3]) + Jinv11*(J[2,1]*w[1] + J[2,2]*w[2] - J[3,3]*w[2] + 2*J[2,3]*w[3])) +
  					p2*(Jinv23*((-J[2,3])*w[1] + J[1,3]*w[2]) + Jinv22*((-J[1,1])*w[1] + J[3,3]*w[1] - J[1,2]*w[2] - 2*J[1,3]*w[3]) + Jinv21*(J[2,1]*w[1] + J[2,2]*w[2] - J[3,3]*w[2] + 2*J[2,3]*w[3])) +
  					p3*(Jinv33*((-J[2,3])*w[1] + J[1,3]*w[2]) + Jinv32*((-J[1,1])*w[1] + J[3,3]*w[1] - J[1,2]*w[2] - 2*J[1,3]*w[3]) + Jinv31*(J[2,1]*w[1] + J[2,2]*w[2] - J[3,3]*w[2] + 2*J[2,3]*w[3]))

a1 = [-J[3,1]*w[2] + J[2,1]*w[3]
			2*J[3,1]*w[1] + J[3,2]*w[2] - J[1,1]*w[3] + J[3,3]*w[3]
		 -2*J[2,1]*w[1] + J[1,1]*w[2] - J[2,2]*w[2] - J[2,3]*w[3]]
a2 = [-J[3,1]*w[1] - 2*J[3,2]*w[2] + J[2,2]*w[3] - J[3,3]*w[3]
			J[3,2]*w[1] - J[1,2]*w[3]
		  J[1,1]*w[1] - J[2,2]*w[1] + 2*J[1,2]*w[2] + J[1,3]*w[3]]
a3 = [J[2,1]*w[1] + J[2,2]*w[2] - J[3,3]*w[2] + 2*J[2,3]*w[3]
 		 -J[1,1]*w[1] + J[3,3]*w[1] - J[1,2]*w[2] - 2*J[1,3]*w[3]
 		 -J[2,3]*w[1] + J[1,3]*w[2]]

xdot[24] = dot(pω, Jinv*a1)
xdot[25] = dot(pω, Jinv*a2)
xdot[26] = dot(pω, Jinv*a3)

(Jinv11*((-J[3,1])*w[2] + J[2,1]*w[3]) + Jinv13*(-2*J[2,1]*w[1] + J[1,1]*w[2] - J[2,2]*w[2] - J[2,3]*w[3]) + Jinv12*(2*J[3,1]*w[1] + J[3,2]*w[2] - J[1,1]*w[3] + J[3,3]*w[3])) +
  						p2*(Jinv21*((-J[3,1])*w[2] + J[2,1]*w[3]) + Jinv23*(-2*J[2,1]*w[1] + J[1,1]*w[2] - J[2,2]*w[2] - J[2,3]*w[3]) + Jinv22*(2*J[3,1]*w[1] + J[3,2]*w[2] - J[1,1]*w[3] + J[3,3]*w[3])) +
  						p3*(Jinv31*((-J[3,1])*w[2] + J[2,1]*w[3]) + Jinv33*(-2*J[2,1]*w[1] + J[1,1]*w[2] - J[2,2]*w[2] - J[2,3]*w[3]) + Jinv32*(2*J[3,1]*w[1] + J[3,2]*w[2] - J[1,1]*w[3] + J[3,3]*w[3]))